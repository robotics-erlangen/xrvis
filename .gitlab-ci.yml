image: xrvis-ci:1.90

stages:
  - check
  #- build-lib
  #- build-bin

check:
  stage: check
  script:
    - mold -run cargo check

## Build the shared libraries and cache the target directory
#
#sslgame-linux-x64-release:
#  stage: build-lib
#  cache:
#    key: "cargo-target-$CI_COMMIT_REF_SLUG"
#    paths:
#      - target
#    policy: pull-push
#  script:
#    - mold -run cargo build --package sslgame --locked
#
#sslgame-windows-x64-release:
#  stage: build-lib
#  cache:
#    key: "cargo-target-$CI_COMMIT_REF_SLUG"
#    paths:
#      - target
#    policy: pull-push
#  script:
#    - mold -run cargo build --package sslgame --locked --target x86_64-pc-windows-gnu
#
#
## Build the binaries using the cache generated by the previous stage
#
#desktop-linux-x64-release:
#  stage: build-bin
#  cache:
#    key: "cargo-target-$CI_COMMIT_REF_SLUG"
#    paths:
#      - target
#    policy: pull
#  script:
#    - mold -run cargo build --package xrvis-desktop --bin xrvis-desktop --release
#  artifacts:
#    paths:
#      - target/release/xrvis-desktop
#
#desktop-windows-x64-release:
#  stage: build-bin
#  cache:
#    key: "cargo-target-$CI_COMMIT_REF_SLUG"
#    paths:
#      - target
#    policy: pull
#  script:
#    - mold -run cargo build --package xrvis-desktop --bin xrvis-desktop --locked --target x86_64-pc-windows-gnu
#  artifacts:
#    paths:
#      - target/x86_64-pc-windows-gnu/release/xrvis-desktop.exe
#
#vr-linux-x64-release:
#  stage: build-bin
#  cache:
#    key: "cargo-target-$CI_COMMIT_REF_SLUG"
#    paths:
#      - target
#    policy: pull
#  script:
#    - mold -run cargo build --package xrvis-vr --bin xrvis-vr --release
#  artifacts:
#    paths:
#      - target/release/xrvis-vr
#
#vr-windows-x64-release:
#  stage: build-bin
#  cache:
#    key: "cargo-target-$CI_COMMIT_REF_SLUG"
#    paths:
#      - target
#    policy: pull
#  script:
#    - mold -run cargo build --package xrvis-vr --bin xrvis-vr --release --target x86_64-pc-windows-gnu
#  artifacts:
#    paths:
#      - target/x86_64-pc-windows-gnu/release/xrvis-vr.exe
